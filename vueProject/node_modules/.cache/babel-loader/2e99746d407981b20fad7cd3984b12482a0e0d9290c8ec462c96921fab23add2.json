{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport _imports_0 from '@/assets/search.png';\nconst _hoisted_1 = {\n  style: {\n    \"margin-bottom\": \"3vh\"\n  }\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"measure_btn\",\n  id: \"btn_regi\",\n  onclick: \"location.href='/measure/register';\"\n}, \"+　등록하기\", -1 /* HOISTED */);\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"measure_btn\",\n  id: \"btn_excle\"\n}, \"엑셀 업로드\", -1 /* HOISTED */);\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"img\", {\n  class: \"measure_btn\",\n  id: \"btn_search\",\n  src: _imports_0,\n  alt: \"\"\n}, null, -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_vue_good_table = _resolveComponent(\"vue-good-table\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"button\", {\n    class: \"measure_btn\",\n    id: \"btn_del\",\n    onClick: _cache[0] || (_cache[0] = $event => $setup.click_del_btn())\n  }, \"선택삭제\"), _createElementVNode(\"button\", {\n    class: \"measure_btn\",\n    id: \"btn_copy\",\n    onClick: _cache[1] || (_cache[1] = $event => $setup.click_copy_btn())\n  }, \"복사하기\"), _createElementVNode(\"button\", {\n    class: \"measure_btn\",\n    id: \"btn_edit\",\n    onClick: _cache[2] || (_cache[2] = $event => $setup.click_edit_btn())\n  }, \"수정하기\"), _hoisted_2, _hoisted_3, _hoisted_4]), _createVNode(_component_vue_good_table, {\n    onSelectedRowsChange: $setup.selectionChanged,\n    columns: $setup.columns,\n    rows: $setup.rows,\n    \"select-options\": {\n      enabled: true,\n      disableSelectInfo: true,\n      selectOnCheckboxOnly: true\n    },\n    \"sort-options\": {\n      enabled: false\n    },\n    \"pagination-options\": {\n      enabled: true,\n      mode: 'pages',\n      perPage: 5\n    }\n  }, {\n    default: _withCtx(() => [_createCommentVNode(\" <template #table-actions>\\n            <button class= \\\"measure_btn\\\" id=\\\"btn_del_input2\\\" @click=\\\"click_del_btn()\\\">선택 삭제</button> \\n            <button class= \\\"measure_btn\\\" id=\\\"btn_edit_input2\\\" @click=\\\"click_edit_btn()\\\" style=\\\"margin-right:1vw; margin-top:1vh; margin-bottom: 1vh;\\\">수정하기</button>\\n          </template> \")]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onSelectedRowsChange\", \"columns\", \"rows\"])]);\n}","map":{"version":3,"names":["_imports_0","style","_createElementVNode","class","id","onclick","src","alt","_createElementBlock","_hoisted_1","onClick","_cache","$event","$setup","click_del_btn","click_copy_btn","click_edit_btn","_hoisted_2","_hoisted_3","_hoisted_4","_createVNode","_component_vue_good_table","onSelectedRowsChange","selectionChanged","columns","rows","enabled","_createCommentVNode"],"sources":["/home/hyemi/carbon/co2-emission-management/vueProject/src/components/measure/MeasuretableATotal.vue"],"sourcesContent":["<template>\n  \n  <div>\n      <div style=\" margin-bottom : 3vh\">\n        <button class=\"measure_btn\" id=\"btn_del\" @click=\"click_del_btn()\">선택삭제</button>\n        <button class=\"measure_btn\" id=\"btn_copy\" @click=\"click_copy_btn()\">복사하기</button>\n        <button class=\"measure_btn\" id=\"btn_edit\"  @click=\"click_edit_btn()\">수정하기</button>\n\n        <button class=\"measure_btn\" id=\"btn_regi\"  onclick=\"location.href='/measure/register';\">+　등록하기</button>\n        <button class=\"measure_btn\" id=\"btn_excle\">엑셀 업로드</button>\n        <img class=\"measure_btn\"  id=\"btn_search\" src=\"@/assets/search.png\" alt=\"\"/>\n      </div>\n      <vue-good-table\n          v-on:selected-rows-change=\"selectionChanged\"\n          :columns=\"columns\"\n          :rows=\"rows\" \n          :select-options=\"{ \n            enabled: true,\n            disableSelectInfo: true,\n            selectOnCheckboxOnly: true,\n          }\"\n          :sort-options=\"{enabled: false}\"\n          :pagination-options=\"{\n              enabled: true,\n              mode: 'pages',\n              perPage: 5\n          }\"\n          >\n          <!-- <template #table-actions>\n            <button class= \"measure_btn\" id=\"btn_del_input2\" @click=\"click_del_btn()\">선택 삭제</button> \n            <button class= \"measure_btn\" id=\"btn_edit_input2\" @click=\"click_edit_btn()\" style=\"margin-right:1vw; margin-top:1vh; margin-bottom: 1vh;\">수정하기</button>\n          </template> -->\n      </vue-good-table>\n  </div>\n</template>\n\n<style>\n.btn{\n  width:20px;\n  height: 10px;\n}\n</style>\n\n<script>\nimport 'vue-good-table-next/dist/vue-good-table-next.css'\nimport { VueGoodTable } from 'vue-good-table-next';\nimport { useStore } from \"vuex\"\nimport { computed, ref} from 'vue';\nimport axios from \"axios\";\nimport { useRouter } from 'vue-router'\n\nexport default {\n  name: 'my-component',\n  setup(){\n      var selected_id = ref([])\n      var columns= [\n        {\n          label: '탄소 배출 내용',\n          field: 'CarbonActivity',\n        },\n        {\n          label: '활동 데이터',\n          field: 'data',\n          type: 'number',\n        },\n        {\n          label: '탄소 배출량',\n          field: 'emissions',\n          type: 'number'\n        },\n        {\n          label: '시작 날짜',\n          field: 'StartDate',\n          type: 'date',\n          dateInputFormat: 'yyyy-MM-dd',\n          dateOutputFormat: 'yyyy-MM-dd',\n        },\n        {\n          label: '종료 날짜',\n          field: 'EndDate',\n          type: 'date',\n          dateInputFormat: 'yyyy-MM-dd',\n          dateOutputFormat: 'yyyy-MM-dd',\n        },\n        {\n          label: '스코프',\n          field: 'scope',\n        }\n      ]\n      var rows = ref([])\n\n      function selectionChanged(params){\n        selected_id.value= (params.selectedRows)\n        console.log(\"선택된 행\",selected_id.value)\n        //선택된 행들을 리스트 형태로 반환 {0: Proxy, 1: Proxy, 2: Proxy}\n      }\n\n      const store = useStore();\n      const router = useRouter();\n\n      function click_del_btn(){\n        store.commit('DelTotalTableContent',selected_id.value); //삭제 버튼 - 한번에 보내도록 개선 필요 \n        for(let key in selected_id.value){\n          del_carbon_data(selected_id.value[key].id)\n        }\n        location.reload();\n        \n      }\n      \n      function click_copy_btn(){\n                console.log(\"복사\",selected_id.value)\n                var config = {\n                    headers:{\n                    \"Authorization\":\"Bearer\"+\" \"+store.state.accessToken\n                    }\n                }\n                for(var row in selected_id.value){\n                    const data = (selected_id.value[row])\n                    console.log(\"row = \"+JSON.stringify(data))\n                    var input_data = {\n                        \"CarbonData\": {\n                            \"StartDate\":(data.StartDate),\n                            \"EndDate\":(data.EndDate),\n                            \"Location\": (data.Location),\n                            \"Scope\":  (data.scope),\n                            \"CarbonActivity\": (data.CarbonActivity),\n                            \"CarbonUnit\": (data.Carbonunit),\n                            \"usage\": (data.data), //carbon data\n                            \"Chief\": \"jeong\",\n                            \"Kind\" :(data.kind),\n                            \"Division\":\"\"\n                        },\n                        \"DetailType\":store.state.CarbonCategories[Number(data.Type)],\n                        //\"RootCom\":\"samsung\",\n                        //\"BelongCom\":\"\",\n                        \"Type\":store.state.CarbonCategories[Number(data.DetailType)]\n                    }\n                    console.log((input_data))\n                    get_total_emission(input_data)\n                }\n                //{id:\"\",content:\"\",data:\"\",emissions:\"\",StartDate:\"\",EndDate:\"\",scope:\"\"}\n                async function get_total_emission(input_data){\n                    await axios.post(\"/CarbonEmission/samsung\",input_data,config).then(res => {\n                        console.log(JSON.stringify(input_data))\n                    })\n                    .catch(error => {\n                        console.log('send data'+JSON.stringify(input_data))\n                        console.log(error)\n                        \n                    })\n                    .finally(() => {\n                    })\n                }\n                store.commit('ResetTable')\n                location.reload();\n            }\n\n      function click_edit_btn(){\n        if(selected_id.value.length == 1){\n          console.log(JSON.stringify(selected_id.value)+\"에딧 버튼\")\n          store.commit('SetTableKind','total_table')\n          store.commit('SetEditOpen',selected_id.value)\n        } \n        //수정 팝업창, 수정 정보후 store를 이용해서 저장\n      }\n\n\n\n      const config = {\n            headers:{\n              Authorization:\"Bearer\"+\" \"+store.state.accessToken,\n              \"Content-Type\": \"text/html; charset=utf-8\",\n            }\n      }\n\n      var group_name = store.state.group_name\n      async function get_data(){\n        await axios.get(\"/CarbonEmission/\"+group_name,config).then(res => {\n              console.log(res.data)\n              \n              for(var i=0;i<res.data.length;i++){\n                var info_list={id:\"\",content:\"\",data:\"\",emissions:\"\",StartDate:\"\",EndDate:\"\",scope:\"\", category:\"\"}\n                info_list.id = res.data[i].id\n                info_list.CarbonActivity = res.data[i].CarbonActivity\n                info_list.data =  res.data[i].CarbonData + res.data[i].CarbonUnit\n                info_list.emissions = res.data[i].CarbonTrans + \"kg\"\n                info_list.StartDate = res.data[i].CarbonInfo.StartDate   //api추가되면 수정 \n                info_list.EndDate = res.data[i].CarbonInfo.EndDate \n                info_list.scope = res.data[i].CarbonInfo.Scope \n                console.log(res.data[i].CarbonInfo.Category )\n                info_list.Type = res.data[i].CarbonInfo.Category \n                rows.value.unshift(info_list)\n              }     \n          })\n          .catch(error => {\n              alert(\"로그인 시간이 만료되었습니다.\")\n              console.log(error)\n              router.push('/');\n          })\n          .finally(() => {\n            console.log(rows.value)\n          })\n      }\n\n      async function del_carbon_data(del_id){\n        await axios.delete(\"/CarbonEmission/\"+del_id).then(res => {\n          })\n          .catch(error => {\n            console.log(error)\n            alert(\"삭제에 실패했습니다.\")\n            router.push('/measure/input1');\n          })\n          .finally(() => {\n          })\n      }\n      return{\n        selected_id,\n        columns,\n        rows,\n        click_del_btn,\n        selectionChanged,\n        click_edit_btn,\n        click_copy_btn,\n        get_data,\n        del_carbon_data\n      }\n  },\n  components: {\n      VueGoodTable,\n  },\n  created(){\n    const store = useStore();\n    this.get_data()\n  },\n};\n</script>"],"mappings":";OAUkDA,UAAyB;;EAPhEC,KAA4B,EAA5B;IAAA;EAAA;AAA4B;gCAK/BC,mBAAA,CAAuG;EAA/FC,KAAK,EAAC,aAAa;EAACC,EAAE,EAAC,UAAU;EAAEC,OAAO,EAAC;GAAqC,QAAM;gCAC9FH,mBAAA,CAA0D;EAAlDC,KAAK,EAAC,aAAa;EAACC,EAAE,EAAC;GAAY,QAAM;gCACjDF,mBAAA,CAA4E;EAAvEC,KAAK,EAAC,aAAa;EAAEC,EAAE,EAAC,YAAY;EAACE,GAAyB,EAAzBN,UAAyB;EAACO,GAAG,EAAC;;;;;uBAR9EC,mBAAA,CA+BM,cA9BFN,mBAAA,CAQM,OARNO,UAQM,GAPJP,mBAAA,CAA+E;IAAvEC,KAAK,EAAC,aAAa;IAACC,EAAE,EAAC,SAAS;IAAEM,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,MAAA,CAAAC,aAAa;KAAI,MAAI,GACtEZ,mBAAA,CAAiF;IAAzEC,KAAK,EAAC,aAAa;IAACC,EAAE,EAAC,UAAU;IAAEM,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,MAAA,CAAAE,cAAc;KAAI,MAAI,GACxEb,mBAAA,CAAkF;IAA1EC,KAAK,EAAC,aAAa;IAACC,EAAE,EAAC,UAAU;IAAGM,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,MAAA,CAAAG,cAAc;KAAI,MAAI,GAEzEC,UAAuG,EACvGC,UAA0D,EAC1DC,UAA4E,C,GAE9EC,YAAA,CAoBiBC,yBAAA;IAnBRC,oBAAoB,EAAET,MAAA,CAAAU,gBAAgB;IAC1CC,OAAO,EAAEX,MAAA,CAAAW,OAAO;IAChBC,IAAI,EAAEZ,MAAA,CAAAY,IAAI;IACV,gBAAc,EAAE;;;;KAIhB;IACA,cAAY,EAAE;MAAAC,OAAA;IAAA,CAAgB;IAC9B,oBAAkB,EAAE;;;;;;sBAMrB,MAGe,CAHfC,mBAAA,gVAGe,C"},"metadata":{},"sourceType":"module","externalDependencies":[]}